<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" type="x-icon" href="admaa.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchant Form Search - ADMAA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --secondary: #2c3e50;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --gray: #7f8c8d;
            --success: #2ecc71;
            --border: #ddd;
            --shadow: 0 4px 15px rgba(0,0,0,0.1);
            --bg-color: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --form-bg: white;
            --text-color: #333;
            --section-bg: #f9fafb;
            --section-border: #f9fafb;
            --input-bg: white;
            --input-border: var(--border);
        }

        body.dark-theme {
            --bg-color: #2c3e50;
            --form-bg: #34495e;
            --text-color: #ecf0f1;
            --section-bg: #293a4a;
            --section-border: #4a637d;
            --input-bg: #4c6883;
            --input-border: #5a748c;
            --border: #5a748c;
            --gray: #bdc3c7;
        }

        body.admaa-theme {
            --bg-color: #FFD700; /* Golden yellow background */
            --form-bg: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffcc00' fill-opacity='0.3' fill-rule='evenodd'/%3E%3C/svg%3E"), linear-gradient(135deg, #FFD700 0%, #FFC400 100%); /* Honeycomb pattern */
            --text-color: #333333;
            --section-bg: rgba(255, 215, 0, 0.7); /* Semi-transparent golden */
            --section-border: #FFD700;
            --input-bg: rgba(255, 255, 255, 0.9); /* Slightly transparent white */
            --input-border: #FF0000; /* Red borders */
            --border: #FF0000; /* Red borders */
            --primary: #FF0000; /* Red for primary elements */
            --primary-dark: #CC0000;
            --secondary: #008000; /* Green for secondary elements */
            --accent: #FF4500;
            --success: #008000; /* Green success */
            --gray: #666666;
            --light: #FFFAF0;
            --shadow: 0 4px 15px rgba(255, 0, 0, 0.2);
        }

        /* Special ADMAA theme border styles */
        body.admaa-theme .container {
            border: 2px solid #FF0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
            background: var(--form-bg);
        }

        body.admaa-theme .search-panel {
            border: 2px solid #FF0000;
            border-left: 4px solid #008000; /* Green accent */
            background: rgba(255, 215, 0, 0.8); /* Golden background with transparency */
            backdrop-filter: blur(5px);
        }

        body.admaa-theme .form-card {
            border: 2px solid #FF0000;
            border-left: 4px solid #008000; /* Green accent */
            background: rgba(255, 215, 0, 0.8); /* Golden background with transparency */
            backdrop-filter: blur(5px);
        }

        body.admaa-theme input,
        body.admaa-theme select,
        body.admaa-theme .search-input,
        body.admaa-theme .dropdown-options {
            border: 2px solid #FF0000;
            background: rgba(255, 255, 255, 0.95); /* More opaque white for inputs */
        }

        body.admaa-theme input:focus,
        body.admaa-theme select:focus,
        body.admaa-theme .search-input:focus {
            border-color: #008000; /* Green on focus */
            box-shadow: 0 0 0 3px rgba(0, 128, 0, 0.2);
            background: rgba(255, 255, 255, 1); /* Full white on focus */
        }

        body.admaa-theme .dropdown-options {
            background: rgba(255, 255, 255, 0.98); /* Almost full white for dropdown */
            backdrop-filter: blur(10px);
        }

        body.admaa-theme .dropdown-option:hover {
            background-color: #FF0000;
            color: white;
        }

        body.admaa-theme .dropdown-option.selected {
            background-color: #008000;
            color: white;
        }

        body.admaa-theme .btn-primary {
            background: linear-gradient(135deg, #FF0000, #CC0000);
            border: 2px solid #008000;
        }

        body.admaa-theme .btn-primary:hover {
            background: linear-gradient(135deg, #CC0000, #990000);
            border-color: #FF0000;
        }

        body.admaa-theme .btn-success {
            background: linear-gradient(135deg, #008000, #006400);
            border: 2px solid #FF0000;
        }

        body.admaa-theme .btn-success:hover {
            background: linear-gradient(135deg, #006400, #004d00);
        }

        body.admaa-theme .btn-secondary {
            background: linear-gradient(135deg, #666666, #4d4d4d);
            border: 2px solid #FF0000;
        }

        body.admaa-theme .form-id {
            background: #FF0000;
            color: white;
            border: 2px solid #008000;
        }

        body.admaa-theme .detail-value {
            border: 2px solid #FF0000;
            background: rgba(255, 255, 255, 0.9);
        }

        body.admaa-theme .pagination-btn {
            border: 2px solid #FF0000;
            background: linear-gradient(135deg, #FF0000, #CC0000);
        }

        body.admaa-theme .pagination-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #CC0000, #990000);
        }

        body.admaa-theme .pagination-btn:disabled {
            background: linear-gradient(135deg, #666666, #4d4d4d);
            opacity: 0.7;
        }

        body.admaa-theme .footer {
            border-top: 2px solid #FF0000;
            background: rgba(255, 215, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        body.admaa-theme .results-header {
            border-bottom: 2px solid #FF0000;
        }

        body.admaa-theme .section-title {
            color: #008000; /* Green section titles */
        }

        body.admaa-theme .pagination {
            border-top: 2px solid #FF0000;
        }

        body.admaa-theme .card-header {
            border-bottom: 2px solid #FF0000;
        }

        body.admaa-theme .qr-info {
            border: 2px solid #FF0000;
            border-left: 4px solid #008000;
            background: rgba(255, 215, 0, 0.9);
            backdrop-filter: blur(5px);
        }

        body.admaa-theme .results-container {
            background: rgba(255, 215, 0, 0.8);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #FF0000;
        }

        body.admaa-theme .header {
            border-bottom: 2px solid #FF0000;
            background: rgba(255, 215, 0, 0.8);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        body.admaa-theme .form-header {
            background: rgba(255, 215, 0, 0.8);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 15px;
            border: 2px solid #FF0000;
        }

        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background-color: var(--form-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            transition: background-color 0.3s, box-shadow 0.3s, border 0.3s;
        }

        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .logo {
            font-weight: bold;
            font-size: 1.8rem;
            color: var(--primary);
            transition: color 0.3s;
        }

        /* ADMAA theme specific logo styling */
        body.admaa-theme .logo {
            color: #FF0000 !important;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-weight: 900;
            background: linear-gradient(45deg, #FF0000, #CC0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light);
        }

        h1 {
            color: var(--secondary);
            margin-bottom: 10px;
            font-weight: 700;
            font-size: 2.2rem;
            transition: color 0.3s;
        }
        
        body.dark-theme h1 {
             color: var(--light);
        }

        body.admaa-theme h1 {
            color: #008000; /* Green for main heading */
        }

        .subtitle {
            color: var(--gray);
            font-size: 1rem;
            margin-top: 0;
            transition: color 0.3s;
        }

        .search-panel {
            background-color: var(--section-bg);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary);
            transition: border 0.3s;
        }

        .search-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 0;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
            transition: color 0.3s;
        }
        
        body.dark-theme label {
             color: var(--gray);
        }

        body.admaa-theme label {
            color: #008000; /* Green labels */
            font-weight: 600;
        }

        input[type="text"], input[type="date"], select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--input-border);
            border-radius: 6px;
            font-size: 15px;
            transition: all 0.3s;
            background-color: var(--input-bg);
            color: var(--text-color);
        }
        
        body.dark-theme input, body.dark-theme select {
            color: var(--light);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        /* Searchable dropdown styles */
        .searchable-select {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--input-border);
            border-radius: 6px;
            margin-bottom: 5px;
            font-size: 14px;
            background-color: var(--input-bg);
            color: var(--text-color);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .dropdown-options {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--input-bg);
            position: absolute;
            width: 100%;
            z-index: 100;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .dropdown-options.show {
            display: block;
        }

        .dropdown-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .dropdown-option:hover {
            background-color: var(--primary);
            color: white;
        }

        .dropdown-option.selected {
            background-color: var(--primary-dark);
            color: white;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .btn-secondary {
            background: var(--gray);
            color: white;
        }

        .btn-secondary:hover {
            background: #6c757d;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }

        .results-container {
            margin-top: 40px;
            display: none;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .results-count {
            font-size: 1.1rem;
            color: var(--gray);
        }

        .form-card {
            background: var(--section-bg);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--success);
            transition: transform 0.3s, border 0.3s;
        }

        .form-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .form-id {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .form-date {
            color: var(--gray);
            font-size: 14px;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .detail-group {
            margin-bottom: 12px;
        }

        .detail-label {
            font-size: 11px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }

        body.admaa-theme .detail-label {
            color: #008000; /* Green detail labels */
            font-weight: 600;
        }

        .detail-value {
            font-size: 14px;
            color: var(--text-color);
            font-weight: 500;
            padding: 8px 12px;
            background: var(--input-bg);
            border-radius: 6px;
            border: 1px solid var(--input-border);
            min-height: 40px;
            display: flex;
            align-items: center;
        }

        .qr-info {
            background: #e8f4fd;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            border-left: 3px solid var(--primary);
        }
        
        body.dark-theme .qr-info {
            background: #293a4a;
        }

        .qr-label {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .pagination-btn {
            padding: 10px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pagination-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
            opacity: 0.5;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--primary-dark);
        }

        .page-info {
            font-size: 14px;
            color: var(--gray);
            font-weight: 600;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            border: 4px solid var(--light);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        body.admaa-theme .spinner {
            border: 4px solid #FFD700;
            border-top: 4px solid #FF0000;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .no-results {
            text-align: center;
            padding: 50px;
            color: var(--gray);
        }

        .no-results i {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--gray);
        }

        #theme-toggle {
            background-color: var(--secondary);
            color: var(--light);
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.3s, color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #theme-toggle:hover {
            background-color: var(--primary-dark);
        }

        .export-btn {
            background: var(--success);
            color: white;
        }

        .export-btn:hover {
            background: #27ae60;
        }

        .section-title {
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--secondary);
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        body.dark-theme .section-title {
             color: var(--light);
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .search-grid {
                grid-template-columns: 1fr;
            }
            
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .pagination {
                flex-direction: column;
                gap: 10px;
            }
            
            .form-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            #theme-toggle {
                width: 100%;
            }
        }
    </style>
</head>
<body class="light-theme">
    <div class="container">
        <div class="form-header">
            <div class="logo">ADMAA - Form Search</div>
            <button id="theme-toggle">
                <i class="fas fa-moon"></i> Toggle Theme
            </button>
        </div>
        
        <div class="header">
            <h1><i class="fas fa-search"></i> Merchant Form Search</h1>
            <p class="subtitle">Search and view submitted merchant forms from the database</p>
        </div>
        
        <div class="search-panel">
            <div class="section-title">
                <i class="fas fa-filter"></i> Search Filters
            </div>
            
            <div class="search-grid">
                <!-- Form fields remain the same -->
                <div class="form-group">
                    <label><i class="fas fa-calendar"></i> MONTH</label>
                    <select id="searchMonth">
                        <option value="">All Months</option>
                        <option value="JAN">JAN</option>
                        <option value="FEB">FEB</option>
                        <option value="APR">APR</option>
                        <option value="MAY">MAY</option>
                        <option value="JUN">JUN</option>
                        <option value="JUL">JUL</option>
                        <option value="AUG">AUG</option>
                        <option value="SEP">SEP</option>
                        <option value="OCT">OCT</option>
                        <option value="NOV">NOV</option>
                        <option value="DEC">DEC</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-user-tie"></i> EMPLOYEE NAME</label>
                    <select id="searchEmployee">
                        <option value="">All Employees</option>
                        <option value="ABDUL REHMAN">ABDUL REHMAN</option>
                        <option value="ABDUL WAHID">ABDUL WAHID</option>
                        <option value="ADEEL ALI">ADEEL ALI</option>
                        <option value="AHMED SAEED">AHMED SAEED</option>
                        <option value="AMIR">AMIR</option>
                        <option value="ANWAR UL HAQ">ANWAR UL HAQ</option>
                        <option value="AQEEL ABBAS">AQEEL ABBAS</option>
                        <option value="ARSALAN">ARSALAN</option>
                        <option value="ARSALAN FAROOQUI">ARSALAN FAROOQUI</option>
                        <option value="ALI ASGHAR">ALI ASGHAR</option>
                        <option value="BILAL">BILAL</option>
                        <option value="CEO">CEO</option>
                        <option value="DANIYAL HASSAN">DANIYAL HASSAN</option>
                        <option value="EBAAD">EBAAD</option>
                        <option value="FAHAD AHMED">FAHAD AHMED</option>
                        <option value="FAKHIR">FAKHIR</option>
                        <option value="HAFIZ YASEEN">HAFIZ YASEEN</option>
                        <option value="HAMZA">HAMZA</option>
                        <option value="HAMZA ALI">HAMZA ALI</option>
                        <option value="HARIS KHAN">HARIS KHAN</option>
                        <option value="HIZBULLAH KHALID">HIZBULLAH KHALID</option>
                        <option value="IMRAN AHMED">IMRAN AHMED</option>
                        <option value="IRFAN SHAHID">IRFAN SHAHID</option>
                        <option value="JOHN">JOHN</option>
                        <option value="JUNAID ALAM">JUNAID ALAM</option>
                        <option value="KAMRAN ALI">KAMRAN ALI</option>
                        <option value="KAREEM UDDIN">KAREEM UDDIN</option>
                        <option value="M.SALMAN">M.SALMAN</option>
                        <option value="M.SHABAN">M.SHABAN</option>
                        <option value="M.SHAYAN">M.SHAYAN</option>
                        <option value="M.SHEHROZ">M.SHEHROZ</option>
                        <option value="M.ZUBAIR">M.ZUBAIR</option>
                        <option value="MUBASHIR ALI">MUBASHIR ALI</option>
                        <option value="NADEEM JABBAR">NADEEM JABBAR</option>
                        <option value="NAEEM">NAEEM</option>
                        <option value="MINHAJ HASSAN">MINHAJ HASSAN</option>
                        <option value="NOMAN RASOOL">NOMAN RASOOL</option>
                        <option value="RAZA HUSSAIN">RAZA HUSSAIN</option>
                        <option value="REHAN ALI SHAH">REHAN ALI SHAH</option>
                        <option value="R T">R T</option>
                        <option value="SADIQ">SADIQ</option>
                        <option value="SALMAN SHEIKH">SALMAN SHEIKH</option>
                        <option value="SHAHAB MUSHARRAF">SHAHAB MUSHARRAF</option>
                        <option value="SHAHROZ KHANZADA">SHAHROZ KHANZADA</option>
                        <option value="SHEIKH RIZWAN">SHEIKH RIZWAN</option>
                        <option value="SHERAZ">SHERAZ</option>
                        <option value="SYED MUNZIR">SYED MUNZIR</option>
                        <option value="UZAIR">UZAIR</option>
                        <option value="WAQAR AHMED">WAQAR AHMED</option>
                        <option value="WAQAS AHMED">WAQAS AHMED</option>
                        <option value="YOUNUS">YOUNUS</option>
                        <option value="ZEESHAN AJMAL">ZEESHAN AJMAL</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-user-tie"></i> EMPLOYEE NAME (Text)</label>
                    <input type="text" id="searchEmployeeText" placeholder="Enter employee name (if not in list)">
                </div>
                
                <div class="form-group searchable-select">
                    <label><i class="fas fa-tag"></i> CATEGORY</label>
                    <input type="text" class="search-input" id="categorySearch" placeholder="Search categories...">
                    <div class="dropdown-options" id="categoryOptions">
                        <div class="dropdown-option" data-value="">All Categories</div>
                        <div class="dropdown-option" data-value="A/C TECHNICIAN">A/C TECHNICIAN</div>
                        <div class="dropdown-option" data-value="ACCESSORIES">ACCESSORIES</div>
                        <div class="dropdown-option" data-value="ALUMINIUM & GLASS">ALUMINIUM & GLASS</div>
                        <div class="dropdown-option" data-value="ART GALLERY">ART GALLERY</div>
                        <div class="dropdown-option" data-value="AUTOMOBILE">AUTOMOBILE</div>
                        <div class="dropdown-option" data-value="AUTO SPARE PARTS">AUTO SPARE PARTS</div>
                        <div class="dropdown-option" data-value="BAKERS">BAKERS</div>
                        <div class="dropdown-option" data-value="BANGAL SHOP">BANGAL SHOP</div>
                        <div class="dropdown-option" data-value="BATTERY SHOP">BATTERY SHOP</div>
                        <div class="dropdown-option" data-value="BEAUTY PARLOR">BEAUTY PARLOR</div>
                        <div class="dropdown-option" data-value="BEDSHEET">BEDSHEET</div>
                        <div class="dropdown-option" data-value="BEVERAGES">BEVERAGES</div>
                        <div class="dropdown-option" data-value="BIKE SHOWROOM">BIKE SHOWROOM</div>
                        <div class="dropdown-option" data-value="BIRTHDAY CELEBRATION">BIRTHDAY CELEBRATION</div>
                        <div class="dropdown-option" data-value="BLOCK WORKS">BLOCK WORKS</div>
                        <div class="dropdown-option" data-value="BOOK SHOP">BOOK SHOP</div>
                        <div class="dropdown-option" data-value="BOUTIQUE">BOUTIQUE</div>
                        <div class="dropdown-option" data-value="BROKER AGENT">BROKER AGENT</div>
                        <div class="dropdown-option" data-value="CANTEEN">CANTEEN</div>
                        <div class="dropdown-option" data-value="CAR ACCESSORIES">CAR ACCESSORIES</div>
                        <div class="dropdown-option" data-value="CAR PARKING">CAR PARKING</div>
                        <div class="dropdown-option" data-value="CAR SHOWROOM">CAR SHOWROOM</div>
                        <div class="dropdown-option" data-value="CARPENTER SHOP">CARPENTER SHOP</div>
                        <div class="dropdown-option" data-value="CAR WASH">CAR WASH</div>
                        <div class="dropdown-option" data-value="CATERING">CATERING</div>
                        <div class="dropdown-option" data-value="CATTLE FARM">CATTLE FARM</div>
                        <div class="dropdown-option" data-value="CD SHOP">CD SHOP</div>
                        <div class="dropdown-option" data-value="CEMENT DEPOT">CEMENT DEPOT</div>
                        <div class="dropdown-option" data-value="CHAPATI STALL">CHAPATI STALL</div>
                        <div class="dropdown-option" data-value="CHICKEN / MEAT SHOP">CHICKEN / MEAT SHOP</div>
                        <div class="dropdown-option" data-value="CLEANER">CLEANER</div>
                        <div class="dropdown-option" data-value="CLINIC">CLINIC</div>
                        <div class="dropdown-option" data-value="CLOTHING / GARMENTS">CLOTHING / GARMENTS</div>
                        <div class="dropdown-option" data-value="COBBLER">COBBLER</div>
                        <div class="dropdown-option" data-value="COLD SHOP">COLD SHOP</div>
                        <div class="dropdown-option" data-value="COMPUTER SHOP">COMPUTER SHOP</div>
                        <div class="dropdown-option" data-value="COSMETICS">COSMETICS</div>
                        <div class="dropdown-option" data-value="COURIER SERVICE">COURIER SERVICE</div>
                        <div class="dropdown-option" data-value="CROCKERY STORE">CROCKERY STORE</div>
                        <div class="dropdown-option" data-value="CTC INCHARGE">CTC INCHARGE</div>
                        <div class="dropdown-option" data-value="CURTAIN SHOP">CURTAIN SHOP</div>
                        <div class="dropdown-option" data-value="CUSHION MAKER">CUSHION MAKER</div>
                        <div class="dropdown-option" data-value="CYCLE SHOP">CYCLE SHOP</div>
                        <div class="dropdown-option" data-value="DAIRY SHOP">DAIRY SHOP</div>
                        <div class="dropdown-option" data-value="DARAZ HOUSE">DARAZ HOUSE</div>
                        <div class="dropdown-option" data-value="DENTIST">DENTIST</div>
                        <div class="dropdown-option" data-value="DESERT SHOP">DESERT SHOP</div>
                        <div class="dropdown-option" data-value="DESIGNER">DESIGNER</div>
                        <div class="dropdown-option" data-value="DIAPER STORE">DIAPER STORE</div>
                        <div class="dropdown-option" data-value="DISTRIBUTOR">DISTRIBUTOR</div>
                        <div class="dropdown-option" data-value="DRIVER">DRIVER</div>
                        <div class="dropdown-option" data-value="DRIVING SCHOOL">DRIVING SCHOOL</div>
                        <div class="dropdown-option" data-value="DRY CLEANER">DRY CLEANER</div>
                        <div class="dropdown-option" data-value="DRY FRUIT SHOP">DRY FRUIT SHOP</div>
                        <div class="dropdown-option" data-value="DYNG CENTER">DYNG CENTER</div>
                        <div class="dropdown-option" data-value="EATERIES/RESTAURANT">EATERIES/RESTAURANT</div>
                        <div class="dropdown-option" data-value="ELECTRIC SHOP">ELECTRIC SHOP</div>
                        <div class="dropdown-option" data-value="ESTATE AGENCY">ESTATE AGENCY</div>
                        <div class="dropdown-option" data-value="EVENT PLANNER">EVENT PLANNER</div>
                        <div class="dropdown-option" data-value="FANCY LIGHTS">FANCY LIGHTS</div>
                        <div class="dropdown-option" data-value="FLOWER SHOP">FLOWER SHOP</div>
                        <div class="dropdown-option" data-value="FOAM">FOAM</div>
                        <div class="dropdown-option" data-value="FOOTBALL CLUB">FOOTBALL CLUB</div>
                        <div class="dropdown-option" data-value="FRUIT/VEGETABLE SHOP">FRUIT/VEGETABLE SHOP</div>
                        <div class="dropdown-option" data-value="FURNITURE SHOWROOM">FURNITURE SHOWROOM</div>
                        <div class="dropdown-option" data-value="GARDENER">GARDENER</div>
                        <div class="dropdown-option" data-value="GAS SHOP">GAS SHOP</div>
                        <div class="dropdown-option" data-value="GENERAL STORE">GENERAL STORE</div>
                        <div class="dropdown-option" data-value="GENERATOR SHOP">GENERATOR SHOP</div>
                        <div class="dropdown-option" data-value="GIFT SHOP">GIFT SHOP</div>
                        <div class="dropdown-option" data-value="GLASS SHOP">GLASS SHOP</div>
                        <div class="dropdown-option" data-value="GYM">GYM</div>
                        <div class="dropdown-option" data-value="HAND EMBROIDERY">HAND EMBROIDERY</div>
                        <div class="dropdown-option" data-value="HARDWARE SHOP">HARDWARE SHOP</div>
                        <div class="dropdown-option" data-value="HOMEOPATHIC">HOMEOPATHIC</div>
                        <div class="dropdown-option" data-value="HOTEL">HOTEL</div>
                        <div class="dropdown-option" data-value="HOUSE HOLD">HOUSE HOLD</div>
                        <div class="dropdown-option" data-value="ICE CREAM SHOP / JUICE CENTER">ICE CREAM SHOP / JUICE CENTER</div>
                        <div class="dropdown-option" data-value="ICE DEPOT">ICE DEPOT</div>
                        <div class="dropdown-option" data-value="IMPORT EXPORT">IMPORT EXPORT</div>
                        <div class="dropdown-option" data-value="INTERIOR DESIGNER">INTERIOR DESIGNER</div>
                        <div class="dropdown-option" data-value="JEWELLERY SHOP">JEWELLERY SHOP</div>
                        <div class="dropdown-option" data-value="KEY MAKER">KEY MAKER</div>
                        <div class="dropdown-option" data-value="LABOUR">LABOUR</div>
                        <div class="dropdown-option" data-value="LAW FIRM">LAW FIRM</div>
                        <div class="dropdown-option" data-value="MARBLE STORE">MARBLE STORE</div>
                        <div class="dropdown-option" data-value="MARKETING">MARKETING</div>
                        <div class="dropdown-option" data-value="MARRIAGE BUREAU">MARRIAGE BUREAU</div>
                        <div class="dropdown-option" data-value="MART">MART</div>
                        <div class="dropdown-option" data-value="MEDICAL STORE">MEDICAL STORE</div>
                        <div class="dropdown-option" data-value="MOBILE ACCESSORIES">MOBILE ACCESSORIES</div>
                        <div class="dropdown-option" data-value="MOBILE REPAIR">MOBILE REPAIR</div>
                        <div class="dropdown-option" data-value="MOBILE SHOP">MOBILE SHOP</div>
                        <div class="dropdown-option" data-value="MOBILE SHOP & COMMUNICATION">MOBILE SHOP & COMMUNICATION</div>
                        <div class="dropdown-option" data-value="NET SERVICE PROVIDER">NET SERVICE PROVIDER</div>
                        <div class="dropdown-option" data-value="OIL DEPOT">OIL DEPOT</div>
                        <div class="dropdown-option" data-value="ONLINE MARKETING">ONLINE MARKETING</div>
                        <div class="dropdown-option" data-value="OPTICS">OPTICS</div>
                        <div class="dropdown-option" data-value="PAINT SHOP">PAINT SHOP</div>
                        <div class="dropdown-option" data-value="PAN SHOP">PAN SHOP</div>
                        <div class="dropdown-option" data-value="PARCEL DELIVERY ONLINE">PARCEL DELIVERY ONLINE</div>
                        <div class="dropdown-option" data-value="PERFUME SHOP">PERFUME SHOP</div>
                        <div class="dropdown-option" data-value="PET SHOP">PET SHOP</div>
                        <div class="dropdown-option" data-value="PHOTOGRAPHER">PHOTOGRAPHER</div>
                        <div class="dropdown-option" data-value="PHOTOSTATE SHOP">PHOTOSTATE SHOP</div>
                        <div class="dropdown-option" data-value="PICO SHOP">PICO SHOP</div>
                        <div class="dropdown-option" data-value="POLICE OFFICER">POLICE OFFICER</div>
                        <div class="dropdown-option" data-value="PRINTING">PRINTING</div>
                        <div class="dropdown-option" data-value="PUNCTURE SHOP">PUNCTURE SHOP</div>
                        <div class="dropdown-option" data-value="REPARING">REPARING</div>
                        <div class="dropdown-option" data-value="RENT A CAR">RENT A CAR</div>
                        <div class="dropdown-option" data-value="RICKSHAW DRIVER">RICKSHAW DRIVER</div>
                        <div class="dropdown-option" data-value="RIDER">RIDER</div>
                        <div class="dropdown-option" data-value="SALE PURCHASE & REPAIR">SALE PURCHASE & REPAIR</div>
                        <div class="dropdown-option" data-value="SALON">SALON</div>
                        <div class="dropdown-option" data-value="SANITARY SHOP">SANITARY SHOP</div>
                        <div class="dropdown-option" data-value="SCRAP">SCRAP</div>
                        <div class="dropdown-option" data-value="SERVICE PROVIDER">SERVICE PROVIDER</div>
                        <div class="dropdown-option" data-value="SHOE SHOP">SHOE SHOP</div>
                        <div class="dropdown-option" data-value="SILAI MACHINE SHOP">SILAI MACHINE SHOP</div>
                        <div class="dropdown-option" data-value="SIM STALL">SIM STALL</div>
                        <div class="dropdown-option" data-value="SNOOKER CLUB">SNOOKER CLUB</div>
                        <div class="dropdown-option" data-value="SOFA REPAIR">SOFA REPAIR</div>
                        <div class="dropdown-option" data-value="SOLAR">SOLAR</div>
                        <div class="dropdown-option" data-value="SPORTS SHOP">SPORTS SHOP</div>
                        <div class="dropdown-option" data-value="STATIONARY">STATIONARY</div>
                        <div class="dropdown-option" data-value="TAILOR">TAILOR</div>
                        <div class="dropdown-option" data-value="TEACHER">TEACHER</div>
                        <div class="dropdown-option" data-value="TOY SHOP">TOY SHOP</div>
                        <div class="dropdown-option" data-value="TRADERS">TRADERS</div>
                        <div class="dropdown-option" data-value="TRAVEL AGENCY">TRAVEL AGENCY</div>
                        <div class="dropdown-option" data-value="TYRE SHOP">TYRE SHOP</div>
                        <div class="dropdown-option" data-value="UNION HOLDER">UNION HOLDER</div>
                        <div class="dropdown-option" data-value="VAPE SHOP">VAPE SHOP</div>
                        <div class="dropdown-option" data-value="WAITER">WAITER</div>
                        <div class="dropdown-option" data-value="WATCH SHOP">WATCH SHOP</div>
                        <div class="dropdown-option" data-value="WATER PLANT">WATER PLANT</div>
                        <div class="dropdown-option" data-value="WELDING SHOP">WELDING SHOP</div>
                        <div class="dropdown-option" data-value="WOOD SHOP">WOOD SHOP</div>
                        <div class="dropdown-option" data-value="WORK SHOP">WORK SHOP</div>
                    </div>
                    <input type="hidden" id="searchCategory" value="">
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-map-marker-alt"></i> LOCATION</label>
                    <select id="searchLocation">
                        <option value="">All Locations</option>
                        <option value="BAHRIA TOWN">BAHRIA TOWN</option>
                        <option value="BALDIA TOWN">BALDIA TOWN</option>
                        <option value="BALDIA TOWNSITE AREA">BALDIA TOWNSITE AREA</option>
                        <option value="CLIFTON">CLIFTON</option>
                        <option value="CLIFTON BLOCK 2">CLIFTON BLOCK 2</option>
                        <option value="CLIFTON-SADDAR">CLIFTON-SADDAR</option>
                        <option value="DHA">DHA</option>
                        <option value="F.B AREA">F.B AREA</option>
                        <option value="G-11 MARKAZ">G-11 MARKAZ</option>
                        <option value="GOLIMAR">GOLIMAR</option>
                        <option value="GUL PLAZA">GUL PLAZA</option>
                        <option value="GULISTAN-E-JOUHAR">GULISTAN-E-JOUHAR</option>
                        <option value="GULISTAN-E-IQBAL">GULISTAN-E-IQBAL</option>
                        <option value="II CHUNDIGARH">II CHUNDIGARH</option>
                        <option value="KEAMARI">KEAMARI</option>
                        <option value="KORANGI">KORANGI</option>
                        <option value="LANDHI">LANDHI</option>
                        <option value="LE MARKET">LE MARKET</option>
                        <option value="LIAQUATABAD">LIAQUATABAD</option>
                        <option value="LYARI">LYARI</option>
                        <option value="MACHAR COLONY">MACHAR COLONY</option>
                        <option value="MALIR">MALIR</option>
                        <option value="MANZOOR COLONY">MANZOOR COLONY</option>
                        <option value="MARIPURE">MARIPURE</option>
                        <option value="MAYMAR">MAYMAR</option>
                        <option value="MEHMOODABAD">MEHMOODABAD</option>
                        <option value="N.KARACHI">N.KARACHI</option>
                        <option value="N.NAZIMABAD">N.NAZIMABAD</option>
                        <option value="NAZIMABAD">NAZIMABAD</option>
                        <option value="ORANGI TOWN">ORANGI TOWN</option>
                        <option value="PECHS">PECHS</option>
                        <option value="SADDAR">SADDAR</option>
                        <option value="SAFOORA">SAFOORA</option>
                        <option value="SCHEME 33">SCHEME 33</option>
                        <option value="SHAH FAISAL">SHAH FAISAL</option>
                        <option value="SHAHRAH-E-FAISAL">SHAHRAH-E-FAISAL</option>
                        <option value="SHERSHAH">SHERSHAH</option>
                        <option value="SITE AREA">SITE AREA</option>
                        <option value="SKARDU">SKARDU</option>
                        <option value="SULTANABAD">SULTANABAD</option>
                        <option value="SUKKAR">SUKKAR</option>
                        <option value="HYDERABAD">HYDERABAD</option>
                        <option value="ISLAMABAD">ISLAMABAD</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-university"></i> BANK</label>
                    <select id="searchBank">
                        <option value="">All Banks</option>
                        <option value="ABL">ABL</option>
                        <option value="AL-BARAKA">AL-BARAKA</option>
                        <option value="ASKARI">ASKARI</option>
                        <option value="BAFL">BAFL</option>
                        <option value="BAHL">BAHL</option>
                        <option value="BKIP">BKIP</option>
                        <option value="BML">BML</option>
                        <option value="BOP">BOP</option>
                        <option value="DIBL">DIBL</option>
                        <option value="EASYPAISA">EASYPAISA</option>
                        <option value="FBL">FBL</option>
                        <option value="HBL">HBL</option>
                        <option value="HMB">HMB</option>
                        <option value="JAZZ CASH">JAZZ CASH</option>
                        <option value="JS">JS</option>
                        <option value="MCB">MCB</option>
                        <option value="MEEZAN">MEEZAN</option>
                        <option value="NAYAPAY">NAYAPAY</option>
                        <option value="NBP">NBP</option>
                        <option value="SCB">SCB</option>
                        <option value="SCBL">SCBL</option>
                        <option value="SILK">SILK</option>
                        <option value="SONBL">SONBL</option>
                        <option value="SONE">SONE</option>
                        <option value="UBL">UBL</option>
                        <option value="UPAISA">UPAISA</option>
                        <option value="ZINDAGI">ZINDAGI</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-check-circle"></i> STATUS-2</label>
                    <select id="searchStatus">
                        <option value="">All Status</option>
                        <option value="DEPLOYED">DEPLOYED</option>
                        <option value="CLOSED">CLOSED</option>
                        <option value="SENT FOR PRINTING">SENT FOR PRINTING</option>
                        <option value="IBAN RECEIVED">IBAN RECEIVED</option>
                    </select>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="searchForms()">
                    <i class="fas fa-search"></i> Search Forms
                </button>
                <button class="btn btn-secondary" onclick="resetFilters()">
                    <i class="fas fa-redo"></i> Reset Filters
                </button>
                <button class="btn btn-success export-btn" onclick="exportResults()" style="display: none;" id="exportBtn">
                    <i class="fas fa-download"></i> Export Results
                </button>
            </div>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Searching merchant forms...</p>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <div class="results-header">
                <h2><i class="fas fa-list"></i> Search Results</h2>
                <div class="results-count" id="resultsCount">Showing 0 results</div>
            </div>
            
            <div id="resultsList"></div>
            
            <div class="pagination" id="pagination">
                <button class="pagination-btn" onclick="previousPage()" id="prevBtn">
                    <i class="fas fa-chevron-left"></i> Previous
                </button>
                <span class="page-info" id="pageInfo">Page 1 of 1</span>
                <button class="pagination-btn" onclick="nextPage()" id="nextBtn">
                    Next <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
        
        <div class="footer" style="margin-top: 40px; text-align: center; padding-top: 20px; border-top: 1px solid var(--border); color: var(--gray);">
            <p>ADMAA Retail Enablement Service (Pvt.) Ltd.<br>
            <i class="fas fa-globe"></i> <a href="https://admaa.pk" target="_blank" style="color: var(--primary);">admaa.pk</a> | 
            <i class="fas fa-phone"></i> 0300-8332737</p>
        </div>
    </div>

    <script>
        // Configuration - Update with your n8n webhook URL
        const N8N_SEARCH_WEBHOOK = 'https://noral.gleeze.com/webhook/form-search';
        
        let currentPage = 1;
        const itemsPerPage = 5;
        let allForms = [];
        let filteredForms = [];

        // Theme Toggle - Now cycles through 3 themes
        const themes = ['light-theme', 'dark-theme', 'admaa-theme'];
        let currentThemeIndex = 0;

        document.getElementById('theme-toggle').addEventListener('click', () => {
            // Remove all theme classes
            themes.forEach(theme => {
                document.body.classList.remove(theme);
            });
            
            // Move to next theme
            currentThemeIndex = (currentThemeIndex + 1) % themes.length;
            const nextTheme = themes[currentThemeIndex];
            
            // Apply next theme
            document.body.classList.add(nextTheme);
            
            // Update button text and icon
            const themeToggle = document.getElementById('theme-toggle');
            const icon = themeToggle.querySelector('i');
            
            switch(nextTheme) {
                case 'light-theme':
                    icon.className = 'fas fa-moon';
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                    break;
                case 'dark-theme':
                    icon.className = 'fas fa-palette';
                    themeToggle.innerHTML = '<i class="fas fa-palette"></i> ADMAA Theme';
                    break;
                case 'admaa-theme':
                    icon.className = 'fas fa-sun';
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                    break;
            }
        });

        // Initialize theme
        document.body.classList.add(themes[currentThemeIndex]);

        // Searchable dropdown functionality for categories
        document.addEventListener('DOMContentLoaded', function() {
            const categorySearch = document.getElementById('categorySearch');
            const categoryOptions = document.getElementById('categoryOptions');
            const hiddenCategoryInput = document.getElementById('searchCategory');
            const dropdownOptions = categoryOptions.querySelectorAll('.dropdown-option');
            
            // Set initial value
            hiddenCategoryInput.value = '';
            
            categorySearch.addEventListener('focus', function() {
                categoryOptions.classList.add('show');
                filterOptions();
            });
            
            categorySearch.addEventListener('input', filterOptions);
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!categorySearch.contains(e.target) && !categoryOptions.contains(e.target)) {
                    categoryOptions.classList.remove('show');
                }
            });
            
            // Handle option selection
            dropdownOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    const text = this.textContent;
                    
                    hiddenCategoryInput.value = value;
                    categorySearch.value = text;
                    categoryOptions.classList.remove('show');
                    
                    // Update selected state
                    dropdownOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            function filterOptions() {
                const searchTerm = categorySearch.value.toLowerCase();
                
                dropdownOptions.forEach(option => {
                    const text = option.textContent.toLowerCase();
                    if (text.includes(searchTerm)) {
                        option.style.display = 'block';
                    } else {
                        option.style.display = 'none';
                    }
                });
            }
        });

        async function searchForms() {
            const searchCriteria = {
                month: document.getElementById('searchMonth').value,
                category: document.getElementById('searchCategory').value,
                location: document.getElementById('searchLocation').value,
                bank: document.getElementById('searchBank').value,
                status: document.getElementById('searchStatus').value,
                employee: document.getElementById('searchEmployee').value,
                employeeText: document.getElementById('searchEmployeeText').value.trim(),
                action: 'search'
            };

            console.log('=== WEBPAGE DEBUG: Sending search ===');
            console.log('Search criteria:', searchCriteria);

            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('exportBtn').style.display = 'none';
            
            try {
                const response = await fetch(N8N_SEARCH_WEBHOOK, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(searchCriteria)
                });
                
                console.log('Response status:', response.status);
                console.log('Response OK?', response.ok);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                console.log('=== WEBPAGE DEBUG: Received response ===');
                console.log('Full response:', data);
                console.log('Success?', data.success);
                console.log('Count?', data.count);
                console.log('Results length?', data.results ? data.results.length : 0);
                console.log('Message?', data.message);
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
                if (data.success && data.results && data.results.length > 0) {
                    console.log(' Will display results');
                    allForms = data.results;
                    filteredForms = allForms;
                    currentPage = 1;
                    displayResults();
                } else {
                    console.log(' Will display NO results');
                    displayNoResults(data.message || 'No forms found');
                }
                
            } catch (error) {
                console.error('Search Error:', error);
                document.getElementById('loading').style.display = 'none';
                displayError('Error searching forms. Please check the connection and try again.');
            }
        }

        function displayResults() {
            console.log('=== DISPLAYING RESULTS ===');
            console.log('Total forms to display:', filteredForms.length);
            
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';
            
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageForms = filteredForms.slice(startIndex, endIndex);
            
            console.log('Page forms:', pageForms.length);
            
            if (pageForms.length === 0) {
                displayNoResults('No forms to display');
                return;
            }
            
            pageForms.forEach((form, index) => {
                console.log(`Creating card for form ${index}:`, form.merchantName || form.ownerName);
                
                const card = document.createElement('div');
                card.className = 'form-card';
                
                // Format MAF Date
                let mafDate = 'N/A';
                if (form.mafDate) {
                    try {
                        const date = new Date(form.mafDate);
                        mafDate = date.toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                    } catch (e) {
                        console.error('Date parsing error:', e);
                    }
                }
                
                card.innerHTML = `
                    <div class="card-header">
                        <div>
                            <h3 style="margin: 0; color: var(--secondary);">${form.merchantName || 'Unnamed Merchant'}</h3>
                            <div class="form-date">MAF Date: ${mafDate}</div>
                        </div>
                        <div class="form-id">S.NO: ${startIndex + index + 1}</div>
                    </div>
                    
                    <div class="details-grid">
                        <div class="detail-group">
                            <div class="detail-label">MAF DATE</div>
                            <div class="detail-value">${form.mafDate || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">MONTH</div>
                            <div class="detail-value">${form.month || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">SALES PERSON</div>
                            <div class="detail-value">${form.salesPerson || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">MERCHANT NAME</div>
                            <div class="detail-value">${form.merchantName || form.ownerName || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">CATEGORY</div>
                            <div class="detail-value">${form.category || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">LOCATION</div>
                            <div class="detail-value">${form.location || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">TEAM</div>
                            <div class="detail-value">${form.team || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">STANDEE TYPE</div>
                            <div class="detail-value">${form.standeeType || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">OWNER NAME</div>
                            <div class="detail-value">${form.ownerName || form.merchantName || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">FATHER NAME</div>
                            <div class="detail-value">${form.fatherName || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">ADDRESS</div>
                            <div class="detail-value">${form.address || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">DOB</div>
                            <div class="detail-value">${form.dob || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">CNIC NO</div>
                            <div class="detail-value">${form.cnicNo || form.cnic || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">PHONE NUMBER</div>
                            <div class="detail-value">${form.phoneNumber || form.mobileNumber || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">BANK NAME</div>
                            <div class="detail-value">${form.bankName || form.bank || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">IBAN NUMBER</div>
                            <div class="detail-value">${form.ibanNumber || form.iban || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">IBAN RECEIVED DATE</div>
                            <div class="detail-value">${form.ibanReceivedDate || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">CONVERTED TO UBL/FAYSAL</div>
                            <div class="detail-value">${form.convertedTo || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">ACCOUNT TITLE</div>
                            <div class="detail-value">${form.accountTitle || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">REMARKS</div>
                            <div class="detail-value">${form.remarks || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">STATUS-2</div>
                            <div class="detail-value">${form.status2 || form.status || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">WHATSAPP/ORIGINAL</div>
                            <div class="detail-value">${form.whatsappOriginal || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">COMMENTS</div>
                            <div class="detail-value">${form.comments || 'N/A'}</div>
                        </div>
                        
                        <div class="detail-group">
                            <div class="detail-label">HAND OVER TO SALES STAFF</div>
                            <div class="detail-value">${form.handOverToSalesStaff || 'N/A'}</div>
                        </div>
                        
                        .detail-group {
                            <div class="detail-label">FBL REFERENCE ID</div>
                            <div class="detail-value">${form.fblReferenceId || form.referalID || 'N/A'}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 12px; color: var(--gray);">
                        <i class="fas fa-info-circle"></i> Last Updated: ${form.timestamp || 'N/A'}
                    </div>
                `;
                resultsList.appendChild(card);
            });
            
            updateResultsCount();
            updatePagination();
            document.getElementById('resultsContainer').style.display = 'block';
            document.getElementById('exportBtn').style.display = 'inline-flex';
            
            // Debug: Check if elements are visible
            console.log('resultsContainer display:', document.getElementById('resultsContainer').style.display);
            console.log('resultsList children:', document.getElementById('resultsList').children.length);
            console.log(' Results displayed successfully');
        }

        function updateResultsCount() {
            const total = filteredForms.length;
            const start = Math.min((currentPage - 1) * itemsPerPage + 1, total);
            const end = Math.min(currentPage * itemsPerPage, total);
            
            document.getElementById('resultsCount').textContent = 
                `Showing ${start}-${end} of ${total} form${total !== 1 ? 's' : ''}`;
        }

        function displayNoResults(message = 'No forms found') {
            console.log('Displaying no results:', message);
            
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-search"></i>
                    <h3>${message}</h3>
                    <p>Try adjusting your search criteria or try different filters.</p>
                    <button class="btn btn-secondary" onclick="resetFilters()" style="margin-top: 20px;">
                        <i class="fas fa-redo"></i> Reset All Filters
                    </button>
                </div>
            `;
            document.getElementById('resultsContainer').style.display = 'block';
            document.getElementById('pagination').style.display = 'none';
            document.getElementById('exportBtn').style.display = 'none';
            
            console.log('No results message displayed');
        }

        function displayError(message) {
            console.log('Displaying error:', message);
            
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-exclamation-triangle" style="color: var(--accent);"></i>
                    <h3>Error</h3>
                    <p>${message}</p>
                    <button class="btn btn-primary" onclick="searchForms()" style="margin-top: 20px;">
                        <i class="fas fa-sync-alt"></i> Try Again
                    </button>
                </div>
            `;
            document.getElementById('resultsContainer').style.display = 'block';
            document.getElementById('pagination').style.display = 'none';
            document.getElementById('exportBtn').style.display = 'none';
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredForms.length / itemsPerPage);
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
            
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages;
            
            document.getElementById('pagination').style.display = totalPages > 1 ? 'flex' : 'none';
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredForms.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayResults();
            }
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayResults();
            }
        }

        function resetFilters() {
            document.getElementById('searchMonth').value = '';
            document.getElementById('searchEmployee').value = '';
            document.getElementById('searchEmployeeText').value = '';
            document.getElementById('searchCategory').value = '';
            document.getElementById('categorySearch').value = '';
            document.getElementById('searchLocation').value = '';
            document.getElementById('searchBank').value = '';
            document.getElementById('searchStatus').value = '';
            
            // Reset category dropdown
            const categoryOptions = document.getElementById('categoryOptions');
            const dropdownOptions = categoryOptions.querySelectorAll('.dropdown-option');
            dropdownOptions.forEach(opt => {
                opt.classList.remove('selected');
                opt.style.display = 'block';
            });
            
            // Select "All Categories" option
            dropdownOptions[0].classList.add('selected');
            document.getElementById('categorySearch').value = 'All Categories';
            
            document.getElementById('resultsContainer').style.display = 'none';
            allForms = [];
            filteredForms = [];
            currentPage = 1;
            document.getElementById('exportBtn').style.display = 'none';
            
            console.log('Filters reset');
        }

        function exportResults() {
            if (filteredForms.length === 0) {
                alert('No results to export.');
                return;
            }
            
            // Convert to CSV with new column headers
            const headers = [
                'S.NO', 'MAF DATE', 'MONTH', 'SALES PERSON', 'MERCHANT NAME',
                'CATEGORY', 'LOCATION', 'TEAM', 'STANDEE TYPE', 'OWNER NAME',
                'FATHER NAME', 'ADDRESS', 'DOB', 'CNIC NO', 'PHONE NUMBER',
                'BANK NAME', 'IBAN NUMBER', 'IBAN RECEIVED DATE', 'CONVERTED TO UBL/FAYSAL',
                'ACCOUNT TITLE', 'REMARKS', 'STATUS-2', 'WHATSAPP/ORIGINAL', 'COMMENTS',
                'HAND OVER TO SALES STAFF', 'FBL REFERENCE ID', 'TIMESTAMP'
            ];
            
            const csvData = filteredForms.map((form, index) => [
                index + 1,
                form.mafDate || '',
                form.month || '',
                form.salesPerson || '',
                form.merchantName || '',
                form.category || '',
                form.location || '',
                form.team || '',
                form.standeeType || '',
                form.ownerName || '',
                form.fatherName || '',
                form.address || '',
                form.dob || '',
                form.cnicNo || form.cnic || '',
                form.phoneNumber || form.mobileNumber || '',
                form.bankName || form.bank || '',
                form.ibanNumber || form.iban || '',
                form.ibanReceivedDate || '',
                form.convertedTo || '',
                form.accountTitle || '',
                form.remarks || '',
                form.status2 || form.status || '',
                form.whatsappOriginal || '',
                form.comments || '',
                form.handOverToSalesStaff || '',
                form.fblReferenceId || form.referalID || '',
                form.timestamp || ''
            ]);
            
            const csvContent = [
                headers.join(','),
                ...csvData.map(row => row.map(cell => `"${cell}"`).join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `merchant_forms_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert(`Exported ${filteredForms.length} forms successfully.`);
        }

        // Allow Enter key to trigger search in any input field
        document.querySelectorAll('input, select').forEach(element => {
            element.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    searchForms();
                }
            });
        });
        
        console.log('Webpage JavaScript loaded successfully');
    </script>
</body>
</html>
